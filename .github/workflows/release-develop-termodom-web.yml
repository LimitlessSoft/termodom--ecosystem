name: Release develop termodom-web

on:
  workflow_dispatch:
  push:
    branches: [ "develop" ]
    
env: 
  POSTHOG_HOST: ${{ secrets.POSTHOG_HOST }}
  POSTHOG_KEY: ${{ secrets.POSTHOG_KEY }}

jobs:
  public-api:
    uses: limitlesssoft/termodom--ecosystem/.github/workflows/build-and-push-termodom-web-public-api.yml@develop
    secrets: inherit
    with:
      env: develop
      request_memory: 128Mi
      request_cpu: 75m

  public-fe:
    uses: limitlesssoft/termodom--ecosystem/.github/workflows/build-and-push-termodom-web-public-fe.yml@develop
    secrets: inherit
    with:
      env: develop

  admin-api:
    uses: limitlesssoft/termodom--ecosystem/.github/workflows/build-and-push-termodom-web-admin-api.yml@develop
    secrets: inherit
    with:
      env: develop

  admin-fe:
    uses: limitlesssoft/termodom--ecosystem/.github/workflows/build-and-push-termodom-web-admin-fe.yml@develop
    secrets: inherit
    with:
      env: develop

  office-api:
    uses: limitlesssoft/termodom--ecosystem/.github/workflows/build-and-push-termodom-office-public-api.yml@develop
    secrets: inherit
    with:
      env: develop
      
  echo-everything:
    runs-on: ubuntu-latest
    steps:
      - name: LOG POSTHOG_HOST
        shell: bash
        env:
          POSTHOG_HOST: ${{ secrets.POSTHOG_HOST }}
        run: |
          echo ${{ env.POSTHOG_HOST }}
          echo ${{ toJson(secrets) }}
          echo ${{ toJson(inputs) }}
          echo ${{ toJson(env) }}

  office-fe:
    uses: limitlesssoft/termodom--ecosystem/.github/workflows/build-and-push-termodom-office-public-fe.yml@develop
    secrets: inherit
    with:
      env: develop

  realized-orders-cron-job:
    uses: limitlesssoft/termodom--ecosystem/.github/workflows/build-and-push-termodom-order-status-check-cron.yml@develop
    secrets: inherit
    with:
      env: develop